{% extends "core/base.html" %}
{% load static %}
{% block title %}Blog - {{company_brand }}{% endblock %}
{% block customjs %}<script src="{% static 'core/js/blog-pagination.js' %}" defer></script>{% endblock %}
{% block content %}

<!-- Page Title -->
<div class="page-title">
  <div class="heading">
    <div class="container">
      <div class="row d-flex justify-content-center text-center">
        <div class="col-lg-8">
          <h1>Blog</h1>
          <p class="mb-0">Odio et unde deleniti. Deserunt numquam exercitationem. Officiis quo odio sint voluptas consequatur ut a odio voluptatem. Sit dolorum debitis veritatis natus dolores. Quasi ratione sint. Sit quaerat ipsum dolorem.</p>
        </div>
      </div>
    </div>
  </div>
  <nav class="breadcrumbs">
    <div class="container">
      <ol>
        <li><a href="{% url 'core:index' %}">Home</a></li>
        <li class="current">Blog</li>
      </ol>
    </div>
  </nav>
</div><!-- End Page Title -->

<div class="container">
  <div class="row">

    <div class="col-lg-8">

      <!-- Blog Posts Section -->
      <section id="blog-posts" class="blog-posts section">
        <div class="container">
          <div class="row gy-4">
            {% if posts %}
              {% for post in posts %}
                <div class="col-12">
                  <article class="rounded">
                    <div class="post-img d-flex justify-content-center align-items-center">
                      {% if post.post_image %}
                        <img src="{{ post.post_image.url }}" alt="{{ post.title }}" class="img-fluid">
                      {% else %}
                        <img src="{% static 'core/img/blog/blog-1.jpg' %}" alt="{{ post.title }}" class="img-fluid rounded-top">
                      {% endif %}
                    </div>
                    <h2 class="title">
                      <a href="{% url 'core:post' post.id %}">{{ post.title }}</a>
                    </h2>
                    <div class="meta-top">
                      <ul>
                        <li class="d-flex align-items-center"><i class="bi bi-person"></i> <a href="{% url 'core:post' post.id %}">{{ post.author }}</a></li>
                        <li class="d-flex align-items-center"><i class="bi bi-clock"></i> <a href="{% url 'core:post' post.id %}"><time datetime="{{ post.date|date:'Y-m-d' }}">{{ post.post_date|date:"M d, Y" }}</time></a></li>
                        <li class="d-flex align-items-center"><i class="bi bi-chat-dots"></i> <a href="{% url 'core:post' post.id %}">{{ post.comments.count }} Comments</a></li>
                      </ul>
                    </div>
                    <div class="content">
                      <p>{{ post.preview|default:post.body|truncatewords:40|safe }}</p>
                      <div class="read-more">
                        <a href="{% url 'core:post' post.id %}">Read More</a>
                      </div>
                    </div>
                    <div class="tags">
                      {% for tag in post.tags.all %}
                        <a href="?tag={{ tag.slug }}">{{ tag.name }}</a>
                      {% endfor %}
                    </div>
                  </article>
                </div>
              {% endfor %}
            {% else %}
              <div class="col-12">
                <p>No posts to display.</p>
              </div>
            {% endif %}  
          </div>
        </div>
      </section>
      
      <!-- Blog Pagination Section -->
      <section id="blog-pagination" class="blog-pagination section">
        <div class="container">
          <div class="d-flex justify-content-center">
            <ul>
              {% if posts.has_previous %}
                <li><a href="?{% if request.GET.category %}category={{ request.GET.category }}&{% endif %}{% if request.GET.tag %}tag={{ request.GET.tag }}&{% endif %}page={{ posts.previous_page_number }}"><i class="bi bi-chevron-left"></i></a></li>
              {% endif %}
              
              {% for page_num in page_range %}
                {% if page_num == '...' %}
                  <li>...</li>
                {% else %}
                  <li><a href="?{% if query %}q={{ query }}&{% endif %}{% if current_category %}category={{ current_category }}&{% endif %}{% if current_tag %}tag={{ current_tag }}&{% endif %}page={{ page_num }}">
                    {{ page_num }}
                  </a></li>
                {% endif %}
              {% endfor %}
              
              {% if posts.has_next %}
                <li><a href="?{% if request.GET.category %}category={{ request.GET.category }}&{% endif %}{% if request.GET.tag %}tag={{ request.GET.tag }}&{% endif %}page={{ posts.next_page_number }}"><i class="bi bi-chevron-right"></i></a></li>
              {% endif %}
            </ul>
          </div>
        </div>
      </section>

    </div>

    <div class="col-lg-4 sidebar">

      <div class="widgets-container">

        <!-- Search Widget -->
        <div class="search-widget widget-item">

          <h3 class="widget-title">Search</h3>
          <form method="get" action="">
            <input type="text" name="q" value="{{ request.GET.q }}" placeholder="Search posts...">
            <button type="submit" title="Search"><i class="bi bi-search"></i></button>
          </form>

        </div><!--/Search Widget -->

        <!-- Categories Widget -->
        <div class="categories-widget widget-item">

          <h3 class="widget-title">Categories</h3>
          <ul class="mt-3">
            <li>
              <a href="{% url 'core:blog2' %}">
                All <span>({{ total_post_count }})</span>
              </a>
            </li>


            {% for category in categories %}
              <li>
                <a href="?category={{ category.slug }}" {% if category.slug == current_category %}class="active"{% endif %}>
                  {{ category.name }} <span>({{ category.post_count }})</span>
                </a>
              </li>
            {% endfor %}
          </ul>

        </div><!--/Categories Widget -->

        <!-- Recent Posts Widget -->
        <div class="recent-posts-widget widget-item">

          <h3 class="widget-title">Recent Posts</h3>

          <div class="post-item">
            <img src="{% static 'core/img/blog/blog-recent-1.jpg' %}" alt="" class="flex-shrink-0">
            <div>
              <h4><a href="blog-details.html">Nihil blanditiis at in nihil autem</a></h4>
              <time datetime="2020-01-01">Jan 1, 2020</time>
            </div>
          </div><!-- End recent post item-->

          <div class="post-item">
            <img src="{% static 'core/img/blog/blog-recent-2.jpg' %}" alt="" class="flex-shrink-0">
            <div>
              <h4><a href="blog-details.html">Quidem autem et impedit</a></h4>
              <time datetime="2020-01-01">Jan 1, 2020</time>
            </div>
          </div><!-- End recent post item-->

          <div class="post-item">
            <img src="{% static 'core/img/blog/blog-recent-3.jpg' %}" alt="" class="flex-shrink-0">
            <div>
              <h4><a href="blog-details.html">Id quia et et ut maxime similique occaecati ut</a></h4>
              <time datetime="2020-01-01">Jan 1, 2020</time>
            </div>
          </div><!-- End recent post item-->

          <div class="post-item">
            <img src="{% static 'core/img/blog/blog-recent-4.jpg' %}" alt="" class="flex-shrink-0">
            <div>
              <h4><a href="blog-details.html">Laborum corporis quo dara net para</a></h4>
              <time datetime="2020-01-01">Jan 1, 2020</time>
            </div>
          </div><!-- End recent post item-->

          <div class="post-item">
            <img src="{% static 'core/img/blog/blog-recent-5.jpg' %}" alt="" class="flex-shrink-0">
            <div>
              <h4><a href="blog-details.html">Et dolores corrupti quae illo quod dolor</a></h4>
              <time datetime="2020-01-01">Jan 1, 2020</time>
            </div>
          </div><!-- End recent post item-->

        </div><!--/Recent Posts Widget -->

        <!-- Tags Widget -->
        <div class="tags-widget widget-item">

          <h3 class="widget-title">Tags</h3>
          <ul>
            {% for tag in tags %}
              <li>
                <a href="?tag={{ tag.slug }}" {% if tag.slug == current_tag %}class="active"{% endif %}>
                  {{ tag.name }} ({{ tag.post_count }})
                </a>
              </li>
            {% endfor %}
          </ul>

        </div><!--/Tags Widget -->

      </div>

    </div>

  </div>
</div>
{% endblock %}
